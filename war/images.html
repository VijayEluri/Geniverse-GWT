<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<!-- The HTML 4.01 Transitional DOCTYPE declaration-->
<!-- above set at the top of the file will set     -->
<!-- the browser's rendering engine into           -->
<!-- "Quirks Mode". Replacing this declaration     -->
<!-- with a "Standards Mode" doctype is supported, -->
<!-- but may lead to some differences in layout.   -->

<html>
  <head>
    <meta http-equiv="content-type" content="text/html; charset=UTF-8">

    <!--                                                               -->
    <!-- Consider inlining CSS to reduce the number of requested files -->
    <!--                                                               -->
    <link type="text/css" rel="stylesheet" href="/geniverse/Geniverse.css">

    <!--                                           -->
    <!-- Any title is fine                         -->
    <!--                                           -->
    <title>Web Application Starter Project</title>
    
    <!--                                           -->
    <!-- This script loads your compiled module.   -->
    <!-- If you add any GWT meta tags, they must   -->
    <!-- be added before this line.                -->
    <!--                                           -->
    <script type="text/javascript" language="javascript" src="/geniverse/geniverse/geniverse.nocache.js"></script>
    <script type="text/javascript" language="javascript">
      var dragon;
    	
    	function getDragonImage() {
    	  if (dragon == null) {
    	    document.getElementById("dragon_image").innerHTML = "Need to get a dragon first...";
    	    return;
    	  }
    	  document.getElementById("dragon_image").innerHTML = "Getting image..."
    	  var onSuccess = function(url) {
    	      document.getElementById("dragon_image").innerHTML = "<img src='" + url + "' />";
    	    };
    	  var onFailure = function(throwable) {
    	      document.getElementById("dragon_image").innerHTML = "Error getting dragon: " + throwable;
    	    };
    	  getDragonImageURL(dragon, 5, onSuccess, onFailure);
    	}
    	
    	function getRandomDragonImage() {
    	  document.getElementById("dragon_image").innerHTML = "Getting image..."
    	  var onSuccess = function(url) {
    	      document.getElementById("dragon_image").innerHTML = "<img src='" + url + "' />";
    	    };
    	  var onFailure = function(throwable) {
    	      document.getElementById("dragon_image").innerHTML = "Error getting dragon: " + throwable;
    	    };
    	  getRandomDragonImageURL(onSuccess, onFailure);
    	}
    	
    	function getDragonChars() {
    	  if (dragon == null) {
    	    document.getElementById("dragon_characteristics").innerHTML = "Need to get a dragon first...";
    	    return;
    	  }
    	  document.getElementById("dragon_characteristics").innerHTML = "Getting characteristics..."
    	  var onSuccess = function(arraylist) {
    	      var characteristics = arraylist.array;
    	      document.getElementById("dragon_characteristics").innerHTML = "Tabulating characteristics..." + arraylist
    	      var out = "<ul>";
    	      for(var i = 0; i < characteristics.length; i++) {
    	        out += "<li>" + characteristics[i] + "</li>";
    	      }
    	      out += "</ul>";
    	      document.getElementById("dragon_characteristics").innerHTML = out;
    	    };
    	  var onFailure = function(throwable) {
    	      document.getElementById("dragon_characteristics").innerHTML = "Error getting dragon characteristics: " + throwable;
    	    };
    	  getDragonCharacteristics(dragon, onSuccess, onFailure);
    	}
    	
    	function getDragon() {
    	  document.getElementById("dragon_info").innerHTML = "Getting info..."
    	  var onSuccess = function(organism) {
    	      dragon = organism;
    	      document.getElementById("dragon_info").innerHTML = "Alleles: " + organism.alleles;
    	      getDragonChars();
    	      getDragonImage();
    	    };
    	  var onFailure = function(throwable) {
    	      dragon = null;
    	      document.getElementById("dragon_info").innerHTML = "Error getting dragon: " + throwable;
    	    };
    	  generateDragonWithCallback(onSuccess, onFailure);
    	}
    </script>
  </head>

  <!--                                           -->
  <!-- The body can have arbitrary html, or      -->
  <!-- you can leave the body empty if you want  -->
  <!-- to create a completely dynamic UI.        -->
  <!--                                           -->
  <body>

    <!-- OPTIONAL: include this if you want history support -->
    <iframe src="javascript:''" id="__gwt_historyFrame" tabIndex='-1' style="position:absolute;width:0;height:0;border:0"></iframe>

    <h1>Web Application Starter Project</h1>

    <table align="center">
      <tr>
        <td colspan="2" style="font-weight:bold;">Please enter your name:</td>        
      </tr>
      <tr>
        <td id="nameFieldContainer"></td>
        <td id="sendButtonContainer"></td>
      </tr>
    </table>
    <div style="text-align: center;">
    	Script button: <b> <a href="javascript:getDragon();">get dragon, characteristics, and image</a> </b>
    </div>
    	<div id="dragon_info" style="text-align: center;"> No dragon info</div>
    	<div id="dragon_characteristics" style="text-align: center;">No dragon characteristics</div>
    	<div id="dragon_image" style="text-align: center;"> No dragon image</div>
  </body>
</html>
